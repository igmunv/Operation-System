# API

## Детали

Системный вызов выполняется посредством генерации программного прерывания `0x22`

Следующие регистры используются для передачи аргументов:

| Register  | Description  |
| :-------------: | :------------- |
| `EAX`  | Номер системного вызова  |
| `EBX`  | 1-й аргумент  |
| `ECX`  | 2-й аргумент  |
| `EDX`  | 3-й аргумент  |
| `ESI`  | 4-й аргумент  |
| `EDI`  | 5-й аргумент  |
| `EAX`  | Возвращаемое значение  |



## Таблица системных вызовов

| Number  | Name  | Description  |
| :-------------: | :------------- | :------------- |
| `0x0`  |      [print_text](#print_text)  |                                    Вывод текста |
| `0x1`  |      [new_line](#new_line)  |                                        Переход на следующую строку |
| `0x2`  |      [cursor_update](#cursor_update)  |                              Обновить курсор |
| `0x3`  |      [clear_display](#clear_display)  |                              Очистить дисплей |
| `0x4`  |      [get_current_symbol](#get_current_symbol)  |                    Получить текущий символ |
| `0x5`  |      [delete_current_symbol](#delete_current_symbol)  |              Удалить текущий символ |
| `0x10`  |     [read_sector](#read_sector)  |                                  Читать определённый сектор диска |
| `0x11`  |     [write_sector](#write_sector)  |                                Записать в определённый сектор диска |
| `0x50`  |     [execute_program](#execute_program)  |                          Указать следующую программу для исполнения |
| `0x100`  |    [get_execute_program](#get_execute_program)  |                  Получить следующую программу для исполнения |
| `0x101`  |    [get_keyboard_buffer](#get_keyboard_buffer)  |                  Получить адрес буффера клавиатуры |
| `0x102`  |    [get_keyboard_buffer_ptr](#get_keyboard_buffer_ptr)  |          Получить текущий индекс (текущее положение) буфера клавиатуры |
| `0x103`  |    [get_keyboard_shift_pressed](#get_keyboard_shift_pressed)  |    Получить флаг: нажата ли клавиша Shift |
| `0x104`  |    [get_keyboard_ctrl_pressed](#get_keyboard_ctrl_pressed)  |      Получить флаг: нажата ли клавиша Ctrl |
| `0x105`  |    [get_keyboard_alt_pressed](#get_keyboard_alt_pressed)  |        Получить флаг: нажата ли клавиша Alt |
| `0x106`  |    [get_display_cursor_pos_x](#get_display_cursor_pos_x)  |        Получить позицию курсора по координате X |
| `0x107`  |    [get_display_cursor_pos_y](#get_display_cursor_pos_y)  |        Получить позицию курсора по координате Y |
| `0x108`  |    [get_ticks](#get_ticks)  |                                      Получить количество тиков с момента запуска системы |
| `0x109`  |    [get_device_count](#get_device_count)  |                        Получить количество устройств |
| `0x10A`  |    [get_device_info](#get_device_info)  |                          Получить адрес массива структур устройств |
| `0x200`  |    [set_display_cursor_pos_x](set_display_cursor_pos_x)  |         Задать положение координаты X |
| `0x201`  |    [set_display_cursor_pos_y](set_display_cursor_pos_y)  |         Задать положение координаты Y |


## Системные вызовы


### print_text

**Номер системного вызова:** `0x0`

**Описание:** Вывод текста

**Аргументы:**
| Register  | Description  |
| :-------------: | :------------- |
| `EBX`  | Адрес строки |
| `ECX`  | Количество байт  |
| `DL`  | X  |
| `DH`  | Y  |
| `SI`  | Цвета символов: младший байт — цвет текста, старший байт — цвет фона  |
| `EDI`  | Индекс устройства вывода  |

**Возвращает:** None

---

### new_line

**Номер системного вызова:** `0x1`

**Описание:** Переход на следующую строку (y += 1)

**Аргументы:** 
| Register  | Description  |
| :-------------: | :------------- |
| `EBX`  | Индекс устройства |

**Возвращает:** None

---

### cursor_update

**Номер системного вызова:** `0x2`

**Описание:** Обновить курсор. Перемещает курсор на текущие координаты x и y

**Аргументы:** 
| Register  | Description  |
| :-------------: | :------------- |
| `EBX`  | Индекс устройства |

**Возвращает:** None

---

### clear_display

**Номер системного вызова:** `0x3`

**Описание:** Очистить дисплей

**Аргументы:** 
| Register  | Description  |
| :-------------: | :------------- |
| `EBX`  | Индекс устройства |

**Возвращает:** None

---

### get_current_symbol

**Номер системного вызова:** `0x4`

**Описание:** Получить текущий символ на экране. Получает символ, на который указывают координаты x и y. Можно задать смещение

**Аргументы:**
| Register  | Description  |
| :-------------: | :------------- |
| `EBX`  | Смещение относительно текущей позиции |
| `EDX`  | Индекс устройства |

**Возвращает:**
| Register  | Description  |
| :-------------: | :------------- |
| `EAX`  | Символ |

---

### delete_current_symbol

**Номер системного вызова:** `0x5`

**Описание:** Удалить текущий символ на экране. Удаляет символ, на который указывают координаты x и y. Можно задать смещение

**Аргументы:**
| Register  | Description  |
| :-------------: | :------------- |
| `EBX`  | Смещение относительно текущей позиции |
| `EDX`  | Индекс устройства |

**Возвращает:**
| Register  | Description  |
| :-------------: | :------------- |
| `EAX`  | Удалённый символ |

---

### read_sector

**Номер системного вызова:** `0x10`

**Описание:** Читать определённый сектор с диска

**Аргументы:**
| Register  | Description  |
| :-------------: | :------------- |
| `EBX`  | Идентификатор диска |
| `ECX`  | Номер сектора |
| `EDX`  | Адрес переменной куда читать (размер 512 байт) |

**Возвращает:**
| Register  | Description  |
| :-------------: | :------------- |
| `EAX`  | 0 - успешно, -1 - неудача |

---

### write_sector

**Номер системного вызова:** `0x11`

**Описание:** Записать в определённый сектор диска

**Аргументы:**
| Register  | Description  |
| :-------------: | :------------- |
| `EBX`  | Идентификатор диска |
| `ECX`  | Номер сектора |
| `EDX`  | Адрес переменной откуда читать (размер 512 байт) |

**Возвращает:**
| Register  | Description  |
| :-------------: | :------------- |
| `EAX`  | 0 - успешно, -1 - неудача |

---

### execute_program

**Номер системного вызова:** `0x50`

**Описание:** Указать номер следующей программы для исполнения

**Аргументы:**
| Register  | Description  |
| :-------------: | :------------- |
| `EBX`  | Номер программы |

**Возвращает:** None

---

### get_execute_program

**Номер системного вызова:** `0x100`

**Описание:** Получить номер следующей программы для исполнения 

**Аргументы:** None

**Возвращает:**
| Register  | Description  |
| :-------------: | :------------- |
| `EAX`  | Номер программы |

---

### get_keyboard_buffer

**Номер системного вызова:** `0x101`

**Описание:** Получить адрес буффера клавиатуры

**Аргументы:** None

**Возвращает:**
| Register  | Description  |
| :-------------: | :------------- |
| `EAX`  | Адрес буффера клавиатуры |

---

### get_keyboard_buffer_ptr

**Номер системного вызова:** `0x102`

**Описание:** Получить текущий индекс (текущее положение) буфера клавиатуры

**Аргументы:** None

**Возвращает:**
| Register  | Description  |
| :-------------: | :------------- |
| `EAX`  | Текущий индекс буфера клавиатуры |

---

### get_keyboard_shift_pressed

**Номер системного вызова:** `0x103`

**Описание:** Получить флаг: нажата ли клавиша Shift

**Аргументы:** None

**Возвращает:**
| Register  | Description  |
| :-------------: | :------------- |
| `EAX`  | 0 - не нажата, 1 - нажата |

---

### get_keyboard_ctrl_pressed

**Номер системного вызова:** `0x104`

**Описание:** Получить флаг: нажата ли клавиша Ctrl

**Аргументы:** None

**Возвращает:**
| Register  | Description  |
| :-------------: | :------------- |
| `EAX`  | 0 - не нажата, 1 - нажата |

---

### get_keyboard_alt_pressed

**Номер системного вызова:** `0x105`

**Описание:** Получить флаг: нажата ли клавиша Alt

**Аргументы:** None

**Возвращает:**
| Register  | Description  |
| :-------------: | :------------- |
| `EAX`  | 0 - не нажата, 1 - нажата |

---

### get_display_cursor_pos_x

**Номер системного вызова:** `0x106`

**Описание:** Получить позицию курсора по координате X

**Аргументы:**
| Register  | Description  |
| :-------------: | :------------- |
| `EBX`  | Индекс устройства |

**Возвращает:**
| Register  | Description  |
| :-------------: | :------------- |
| `EAX`  | Позиция курсора по X |

---

### get_display_cursor_pos_y

**Номер системного вызова:** `0x107`

**Описание:** Получить позицию курсора по координате Y

**Аргументы:**
| Register  | Description  |
| :-------------: | :------------- |
| `EBX`  | Индекс устройства |

**Возвращает:**
| Register  | Description  |
| :-------------: | :------------- |
| `EAX`  | Позиция курсора по Y |

---

### get_ticks

**Номер системного вызова:** `0x108`

**Описание:** Получить количество тиков с момента запуска системы

**Аргументы:** None

**Возвращает:**
| Register  | Description  |
| :-------------: | :------------- |
| `EAX`  | Количество тиков |

---

### get_device_count

**Номер системного вызова:** `0x109`

**Описание:** Получить количество устройств

**Аргументы:** None

**Возвращает:**
| Register  | Description  |
| :-------------: | :------------- |
| `EAX`  | Количество устройств |

---

### get_device_info

**Номер системного вызова:** `0x10A`

**Описание:** Получить адрес массива с устройствами

**Аргументы:** None

**Возвращает:**
| Register  | Description  |
| :-------------: | :------------- |
| `EAX`  | Адрес массива |

---
